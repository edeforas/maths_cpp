// Cordic by J. LAPORTE Sept 80

// public domain?

#include <iostream>
#include <cmath>
using namespace std;

int main()
{
    double a[] =
    {
        0.78539816339744828000,
        0.09966865249116203800,
        0.00999966668666523760,
        0.00099999966666686679,
        0.00009999999966666667,
        0.00000999999999966667,
        0.00000099999999999967,
        0.00000010000000000000,
        0.00000001000000000000,
        0.00000000100000000000,
        0.00000000010000000000,
        0.00000000001000000000,
        0.00000000000100000000,
        0.00000000000010000000,
        0.00000000000001000000,
        0.00000000000000100000,
        0.00000000000000010000,
        0.00000000000000001000,
        0.00000000000000000100,
        0.00000000000000000010,
        0.00000000000000000001,
    };

    double ki[] =
    {
        1.00000000000000000000,
        0.10000000000000000000,
        0.01000000000000000000,
        0.00100000000000000000,
        0.00010000000000000000,
        0.00001000000000000000,
        0.00000100000000000000,
        0.00000010000000000000,
        0.00000001000000000000,
        0.00000000100000000000,
        0.00000000010000000000,
        0.00000000001000000000,
        0.00000000000100000000,
        0.00000000000010000000,
        0.00000000000001000000,
        0.00000000000000100000,
        0.00000000000000010000,
        0.00000000000000001000,
        0.00000000000000000100,
        0.00000000000000000010,
        0.00000000000000000001,
    };

    double angle=1.5;
    double Y=0.;
    double X=1.;

    int i=0;
    int n=20;
    while (i!=n)
    {
        if (angle > a[i])
        {
            double k = ki[i];
            angle = angle - a[i];
            double oldX=X;
            X = X - (k * Y);
            Y = Y + (k * oldX);
            cout << "*";
        }
        else
            i++;

        cout << "X=" << X << " Y=" << Y << " angle= " << angle << endl;
    }

    cout << "tan=" << Y/X << endl;

    return 0;
}

